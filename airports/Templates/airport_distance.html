{% load static %}
<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Distancia entre Aeropuertos</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background: linear-gradient(135deg, #74b9ff, #55efc4);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        font-family: "Segoe UI", sans-serif;
      }
      .card {
        border-radius: 20px;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      }
      .btn-custom {
        background: #0984e3;
        color: white;
        font-weight: bold;
        transition: 0.3s;
      }
      .btn-custom:hover {
        background: #74b9ff;
      }
      .result-box {
        background: #f1f2f6;
        padding: 15px;
        border-radius: 12px;
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="card p-4 col-md-6 mx-auto">
        <h2 class="text-center mb-4">✈️ Distancia entre Aeropuertos</h2>

        <form id="distanceForm">
          {% csrf_token %}
          <div class="mb-3">
            <label for="aeropuerto_origen" class="form-label"
              >Código IATA Origen</label
            >
            <input
              type="text"
              name="aeropuerto_origen"
              id="aeropuerto_origen"
              class="form-control text-uppercase"
              placeholder="Ej: BOG"
              required
              maxlength="3"
            />
          </div>

          <div class="mb-3">
            <label for="aeropuerto_destino" class="form-label"
              >Código IATA Destino</label
            >
            <input
              type="text"
              name="aeropuerto_destino"
              id="aeropuerto_destino"
              class="form-control text-uppercase"
              placeholder="Ej: MIA"
              required
              maxlength="3"
            />
          </div>

          <div class="d-grid">
            <button type="submit" class="btn btn-custom">
              Calcular Distancia
            </button>
          </div>
        </form>

        <div id="result" class="result-box d-none"></div>
      </div>
    </div>

    <script>
      document
        .getElementById("distanceForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();
          const formData = new FormData(this);

          let response = await fetch(
            "{% url 'airports:calculate_distance' %}",
            {
              method: "POST",
              body: formData,
            }
          );
          let data = await response.json();

          let resultBox = document.getElementById("result");
          resultBox.classList.remove("d-none");

          if (data.success) {
            resultBox.innerHTML = `
                    <h5>Resultado:</h5>
                    <p><strong>Origen:</strong> ${data.data.origen.nombre} (${data.data.origen.iata}) - ${data.data.origen.ciudad}, ${data.data.origen.pais}</p>
                    <p><strong>Destino:</strong> ${data.data.destino.nombre} (${data.data.destino.iata}) - ${data.data.destino.ciudad}, ${data.data.destino.pais}</p>
                    <p><strong>Distancia:</strong> ${data.data.distancia_km} km | ${data.data.distancia_millas} millas</p>
                `;
          } else {
            resultBox.innerHTML = `<div class="alert alert-danger">${data.error}</div>`;
          }
        });
    </script>
  </body>
</html>
